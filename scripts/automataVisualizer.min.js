"use strict";!function(){function e(){d=document.querySelector("#canvas"),m=d.getContext("2d"),p=document.querySelector("audio"),b=s(p),l(),i(p,z),a.init(50),t()}function s(e){var s=void 0,l=void 0,i=void 0;return s=new(window.AudioContext||window.webkitAudioContext),l=s.createAnalyser(),l.fftSize=u,i=s.createMediaElementSource(e),i.connect(l),l.connect(s.destination),l}function l(){d.onmousemove=h,A=document.querySelector("#rSlider"),y=document.querySelector("#gSlider"),S=document.querySelector("#bSlider"),f=document.querySelector("#rTintSlider"),R=document.querySelector("#gTintSlider"),B=document.querySelector("#bTintSlider"),q=document.querySelector("#aTintSlider"),C=document.querySelector("#thresholdSlider"),document.querySelector("#canvas").onclick=function(e){if(E===!0&&(A.value=a.cells[M.x][M.y].r,y.value=a.cells[M.x][M.y].g,S.value=a.cells[M.x][M.y].b),G===!0)if(w===!1)T.x=M.x,T.y=M.y,w=!0;else{var s=a.getCellData(M);a.cells[M.x][M.y]=a.getCellData(T),a.cells[T.x][T.y]=s,w=!1}},document.querySelector("#canvas").onmousedown=function(e){x=!0},document.querySelector("#canvas").onmouseup=function(e){x=!1},document.querySelector("#trackSelect").onchange=function(e){i(p,e.target.value)},document.querySelector("#changeColorButton").onclick=function(){N=!0,G=!1,w=!1,E=!1,document.querySelector("#changeColorButton").style.backgroundColor="#696969",document.querySelector("#changePosButton").style.backgroundColor="#A9A9A9",document.querySelector("#getColorButton").style.backgroundColor="#A9A9A9",document.querySelector("#toolInfo").innerHTML="Hold the mouse down to add color to the selected cell"},document.querySelector("#changePosButton").onclick=function(){N=!1,G=!0,w=!1,E=!1,document.querySelector("#changeColorButton").style.backgroundColor="#A9A9A9",document.querySelector("#changePosButton").style.backgroundColor="#696969",document.querySelector("#getColorButton").style.backgroundColor="#A9A9A9",document.querySelector("#toolInfo").innerHTML="Click on the cell and then click on another to swap their positions."},document.querySelector("#getColorButton").onclick=function(){N=!1,G=!1,w=!1,E=!0,document.querySelector("#changeColorButton").style.backgroundColor="#A9A9A9",document.querySelector("#changePosButton").style.backgroundColor="#A9A9A9",document.querySelector("#getColorButton").style.backgroundColor="#696969",document.querySelector("#toolInfo").innerHTML="Click on a cell to get the cells color"},document.querySelector("#view3DCheck").onchange=function(e){a.view3D=e.target.checked,N=!1,G=!1,w=!1,E=!1,document.querySelector("#changeColorButton").style.backgroundColor="#A9A9A9",document.querySelector("#changePosButton").style.backgroundColor="#A9A9A9",document.querySelector("#getColorButton").style.backgroundColor="#A9A9A9",e.target.checked?(document.querySelector("#canvas3D").style.display="block",document.querySelector("#canvas").style.display="none",document.querySelector("#toolInfo").innerHTML="Hold left mouse button to rotate camera view <br> Hold middle mouse button to zoom in and out <br> Hold right mouse button to move camera"):(document.querySelector("#canvas3D").style.display="none",document.querySelector("#canvas").style.display="block",document.querySelector("#toolInfo").innerHTML="Click on a cell to get the cells color")}}function i(e,s){e.src=s,e.play(),e.volume=.75,document.querySelector("#status").innerHTML="Now playing: "+s}function t(){if(requestAnimationFrame(t),-1!=M.x){var e=a.getCellData(M),s="<p>R: "+e.r+"</p>";s+="<p>G: "+e.g+"</p>",s+="<p>B: "+e.b+"</p>",s+=e.energized?"<p>Energized: True </p>":"<p>Energized: False </p>",document.querySelector("#cellData").innerHTML=s,document.querySelector("#cellColor").style.backgroundColor=r(e.r,e.g,e.b,1)}M.x=Math.floor(H.x/12.8),M.y=Math.floor(H.y/12.8),M.x<0&&(M.x=0),M.y<0&&(M.y=0),M.x>49&&(M.x=49),M.y>49&&(M.y=49),N===!0&&x===!0&&(a.cells[M.x][M.y].r=A.value,a.cells[M.x][M.y].g=y.value,a.cells[M.x][M.y].b=S.value,a.cells[M.x][M.y].a=1,a.cells[M.x][M.y].isAlive=!0),document.querySelector("#rValue").innerHTML=A.value,document.querySelector("#gValue").innerHTML=y.value,document.querySelector("#bValue").innerHTML=S.value,document.querySelector("#newColor").style.backgroundColor=r(A.value,y.value,S.value,1),document.querySelector("#rTintValue").innerHTML=f.value,document.querySelector("#gTintValue").innerHTML=R.value,document.querySelector("#bTintValue").innerHTML=B.value,document.querySelector("#aTintValue").innerHTML=q.value,document.querySelector("#thresholdValue").innerHTML=C.value,document.querySelector("#newTintColor").style.backgroundColor=r(f.value,R.value,B.value,q.value),k=r(f.value,R.value,B.value,q.value);var l=new Uint8Array(u/2);v&&1!=g&&b.getByteFrequencyData(l),m.clearRect(0,0,640,640),a.updateAll(l,H,M,k),m.beginPath(),m.fillStyle="rgba("+A.value+", "+y.value+", "+S.value+", 1)",m.strokeStyle="rgba(255, 255, 255, 1)",m.arc(H.x,H.y,4,2*Math.PI,!1),m.fill(),m.stroke(),m.closePath()}function h(e){H=c(e)}function c(e){var s={};return s.x=e.pageX-e.target.offsetLeft,s.y=e.pageY-e.target.offsetTop,s}function r(e,s,l,i){var t="rgba("+e+","+s+","+l+", "+i+")";return t}function o(e,s){return Math.floor(Math.random()*(s-e)+e)}var n={isAlive:!1,tempR:0,tempG:0,tempB:0,tempA:0,r:0,g:0,b:0,a:0,neighbours:0,isSpawner:!1,sampleNum:0,energized:!1,energizedNeighbours:0},a={size:0,cells:void 0,geometries:[],lights:[],shaders:[],mouseControls:null,view3D:!1,updateRate:0,init:function(e){this.size=e,this.cells=[],this.setup();for(var s=0,l=0;e>l;l++){this.cells.push([]);for(var i=0;e>i;i++)this.cells[l].push(Object.create(n)),this.createBox(l,i),l%3==2&&i%6==3&&(this.cells[l][i].r=o(100,255),this.cells[l][i].g=o(100,255),this.cells[l][i].b=o(100,255),this.cells[l][i].isSpawner=!0,this.cells[l][i].isAlive=!0,this.cells[l][i].sampleNum=s,s++)}this.createLights();this.setupEffectsComposer();this.shader()},setup:function(){this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(75,1,.1,1e3),this.camera.position.z=51,this.renderer=new THREE.WebGLRenderer({canvas:document.querySelector("#canvas3D")}),this.mouseControls=new THREE.OrbitControls(a.camera,this.renderer.domElement,this.renderer.domElement),a.mouseControls.addEventListener("change",function(){a.composer.render()}),this.renderer.setSize(640,640)},createLights:function(){if(!(this.lights.length>1)){var e=new THREE.AmbientLight(16777215),s=new THREE.PointLight(16777215);s.position.x=100,s.position.y=100,s.position.z=-130;var l=new THREE.PointLight(6710886);l.position.x=0,l.position.y=0,l.position.z=260,this.lights.push(e,s,l),this.scene.add(e),this.scene.add(s),this.scene.add(l)}},setupEffectsComposer:function(){return this.composer=new THREE.EffectComposer(this.renderer),this.renderScene=new THREE.RenderPass(this.scene,this.camera),this.renderScene.clear=!0,this.renderScene.renderToScreen=!0,this.composer.addPass(this.renderScene),this.composer},shader:function L(){var L=new THREE.ShaderPass(THREE.CopyShader);L.renderToScreen=!0,this.shaders.push(L),this.composer.addPass(L)},createBox:function(e,s){var l=new THREE.BoxGeometry(1,1,1),i=new THREE.MeshPhongMaterial({color:16777215,shading:THREE.FlatShading,shininess:50});i.transparent=!0;var t=new THREE.Mesh(l,i);t.position.x=1.5*e-36.5,t.position.y=-1.5*s+36.5,this.geometries.push(t),this.scene.add(t)},draw:function(e,s,l){for(var i=0;i<this.size;i++)for(var t=0;t<this.size;t++)m.fillStyle=r(this.cells[i][t].r,this.cells[i][t].g,this.cells[i][t].b,this.cells[i][t].a),m.strokeStyle="#C0C0C0",this.cells[i][t].isSpawner===!0&&this.cells[i][t].isAlive===!1&&m.strokeRect(640*i/this.size,640*t/this.size,640/this.size,640/this.size),this.cells[i][t].isSpawner===!0&&this.cells[i][t].isAlive===!0?(m.fillRect(640*i/this.size,640*t/this.size,640/this.size,640/this.size),m.strokeRect(640*i/this.size,640*t/this.size,640/this.size,640/this.size),this.cells[i][t].energized===!0&&(m.fillStyle=l,m.fillRect(640*i/this.size,640*t/this.size,640/this.size,640/this.size))):this.cells[i][t].isAlive===!0&&(m.fillRect(640*i/this.size,640*t/this.size,640/this.size,640/this.size),this.cells[i][t].energized===!0&&(m.fillStyle=l,m.fillRect(640*i/this.size,640*t/this.size,640/this.size,640/this.size)));Math.floor(e.x/12.8),Math.floor(e.y/12.8);-1!=s.x&&(m.strokeStyle="red",m.strokeRect(640*s.x/this.size,640*s.y/this.size,640/this.size,640/this.size)),w===!0&&(m.strokeStyle="rgb(0, 255, 0)",m.strokeRect(640*T.x/a.size,640*T.y/a.size,640/a.size,640/a.size))},updateSpawners:function(e){for(var s=0;s<this.size;s++)for(var l=0;l<this.size;l++)if(this.cells[s][l].isSpawner===!0){var i=this.cells[s][l].sampleNum;0==e[i]?this.cells[s][l].isAlive=!1:(this.cells[s][l].isAlive=!0,this.cells[s][l].a=e[i]/255),e[i]>C.value?this.cells[s][l].energized=!0:this.cells[s][l].energized=!1}},checkNeighbours:function(){for(var e=0;e<this.size;e++)for(var s=0;s<this.size;s++)this.cells[e][s].isSpawner===!1&&(0===e&&0===s?(this.cells[1][0].isAlive===!0&&(this.cells[0][0].neighbours++,this.cells[0][0].tempR+=this.cells[1][0].r*this.cells[1][0].a,this.cells[0][0].tempG+=this.cells[1][0].g*this.cells[1][0].a,this.cells[0][0].tempB+=this.cells[1][0].b*this.cells[1][0].a,this.cells[0][0].tempA+=this.cells[1][0].a),this.cells[1][1].isAlive===!0&&(this.cells[0][0].neighbours++,this.cells[0][0].tempR+=this.cells[1][1].r*this.cells[1][1].a,this.cells[0][0].tempG+=this.cells[1][1].g*this.cells[1][1].a,this.cells[0][0].tempB+=this.cells[1][1].b*this.cells[1][1].a,this.cells[0][0].tempA+=this.cells[1][1].a),this.cells[0][1].isAlive===!0&&(this.cells[0][0].neighbours++,this.cells[0][0].tempR+=this.cells[0][1].r*this.cells[0][1].a,this.cells[0][0].tempG+=this.cells[0][1].g*this.cells[0][1].a,this.cells[0][0].tempB+=this.cells[0][1].b*this.cells[0][1].a,this.cells[0][0].tempA+=this.cells[0][1].a),this.cells[1][0].energized===!0&&this.cells[0][0].energizedNeighbours++,this.cells[1][1].energized===!0&&this.cells[0][0].energizedNeighbours++,this.cells[0][1].energized===!0&&this.cells[0][0].energizedNeighbours++):0===e&&s===this.size-1?(this.cells[1][this.size-1].isAlive===!0&&(this.cells[0][this.size-1].neighbours++,this.cells[0][this.size-1].tempR+=this.cells[1][this.size-1].r*this.cells[1][this.size-1].a,this.cells[0][this.size-1].tempG+=this.cells[1][this.size-1].g*this.cells[1][this.size-1].a,this.cells[0][this.size-1].tempB+=this.cells[1][this.size-1].b*this.cells[1][this.size-1].a,this.cells[0][this.size-1].tempA+=this.cells[1][this.size-1].a),this.cells[1][this.size-2].isAlive===!0&&(this.cells[0][this.size-1].neighbours++,this.cells[0][this.size-1].tempR+=this.cells[1][this.size-2].r*this.cells[1][this.size-2].a,this.cells[0][this.size-1].tempG+=this.cells[1][this.size-2].g*this.cells[1][this.size-2].a,this.cells[0][this.size-1].tempB+=this.cells[1][this.size-2].b*this.cells[1][this.size-2].a,this.cells[0][this.size-1].tempA+=this.cells[1][this.size-2].a),this.cells[0][this.size-2].isAlive===!0&&(this.cells[0][this.size-1].neighbours++,this.cells[0][this.size-1].tempR+=this.cells[0][this.size-2].r*this.cells[0][this.size-2].a,this.cells[0][this.size-1].tempG+=this.cells[0][this.size-2].g*this.cells[0][this.size-2].a,this.cells[0][this.size-1].tempB+=this.cells[0][this.size-2].b*this.cells[0][this.size-2].a,this.cells[0][this.size-1].tempA+=this.cells[0][this.size-2].a),this.cells[1][this.size-1].energized===!0&&this.cells[0][this.size-1].energizedNeighbours++,this.cells[1][this.size-2].energized===!0&&this.cells[0][this.size-1].energizedNeighbours++,this.cells[0][this.size-2].energized===!0&&this.cells[0][this.size-1].energizedNeighbours++):e==this.size-1&&0===s?(this.cells[this.size-2][0].isAlive===!0&&(this.cells[this.size-1][0].neighbours++,this.cells[this.size-1][0].tempR+=this.cells[this.size-2][0].r*this.cells[this.size-2][0].a,this.cells[this.size-1][0].tempG+=this.cells[this.size-2][0].g*this.cells[this.size-2][0].a,this.cells[this.size-1][0].tempB+=this.cells[this.size-2][0].b*this.cells[this.size-2][0].a,this.cells[this.size-1][0].tempA+=this.cells[this.size-2][0].a),this.cells[this.size-2][1].isAlive===!0&&(this.cells[this.size-1][0].neighbours++,this.cells[this.size-1][0].tempR+=this.cells[this.size-2][1].r*this.cells[this.size-2][1].a,this.cells[this.size-1][0].tempG+=this.cells[this.size-2][1].g*this.cells[this.size-2][1].a,this.cells[this.size-1][0].tempB+=this.cells[this.size-2][1].b*this.cells[this.size-2][1].a,this.cells[this.size-1][0].tempA+=this.cells[this.size-2][1].a),this.cells[this.size-1][1].isAlive===!0&&(this.cells[this.size-1][0].neighbours++,this.cells[this.size-1][0].tempR+=this.cells[this.size-1][1].r*this.cells[this.size-1][1].a,this.cells[this.size-1][0].tempG+=this.cells[this.size-1][1].g*this.cells[this.size-1][1].a,this.cells[this.size-1][0].tempB+=this.cells[this.size-1][1].b*this.cells[this.size-1][1].a,this.cells[this.size-1][0].tempA+=this.cells[this.size-1][1].a),this.cells[this.size-2][0].energized===!0&&this.cells[this.size-1][0].energizedNeighbours++,this.cells[this.size-2][1].energized===!0&&this.cells[this.size-1][0].energizedNeighbours++,this.cells[this.size-1][1].energized===!0&&this.cells[this.size-1][0].energizedNeighbours++):e==this.size-1&&s==this.size-1?(this.cells[this.size-2][this.size-1].isAlive===!0&&(this.cells[this.size-1][this.size-1].neighbours++,this.cells[this.size-1][this.size-1].tempR+=this.cells[this.size-2][this.size-1].r*this.cells[this.size-2][this.size-1].a,this.cells[this.size-1][this.size-1].tempG+=this.cells[this.size-2][this.size-1].g*this.cells[this.size-2][this.size-1].a,this.cells[this.size-1][this.size-1].tempB+=this.cells[this.size-2][this.size-1].b*this.cells[this.size-2][this.size-1].a,this.cells[this.size-1][this.size-1].tempA+=this.cells[this.size-2][this.size-1].a),this.cells[this.size-2][this.size-2].isAlive===!0&&(this.cells[this.size-1][this.size-1].neighbours++,this.cells[this.size-1][this.size-1].tempR+=this.cells[this.size-2][this.size-2].r*this.cells[this.size-2][this.size-2].a,this.cells[this.size-1][this.size-1].tempG+=this.cells[this.size-2][this.size-2].g*this.cells[this.size-2][this.size-2].a,this.cells[this.size-1][this.size-1].tempB+=this.cells[this.size-2][this.size-2].b*this.cells[this.size-2][this.size-2].a,this.cells[this.size-1][this.size-1].tempA+=this.cells[this.size-2][this.size-2].a),this.cells[this.size-1][this.size-2].isAlive===!0&&(this.cells[this.size-1][this.size-1].neighbours++,this.cells[this.size-1][this.size-1].tempR+=this.cells[this.size-1][this.size-2].r*this.cells[this.size-1][this.size-2].a,this.cells[this.size-1][this.size-1].tempG+=this.cells[this.size-1][this.size-2].g*this.cells[this.size-1][this.size-2].a,this.cells[this.size-1][this.size-1].tempB+=this.cells[this.size-1][this.size-2].b*this.cells[this.size-1][this.size-2].a,this.cells[this.size-1][this.size-1].tempA+=this.cells[this.size-1][this.size-2].a),this.cells[this.size-2][this.size-1].energized===!0&&this.cells[this.size-1][this.size-1].energizedNeighbours++,this.cells[this.size-2][this.size-2].energized===!0&&this.cells[this.size-1][this.size-1].energizedNeighbours++,this.cells[this.size-1][this.size-2].energized===!0&&this.cells[this.size-1][this.size-1].energizedNeighbours++):0===s?(this.cells[e-1][s].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e-1][s].r*this.cells[e-1][s].a,this.cells[e][s].tempG+=this.cells[e-1][s].g*this.cells[e-1][s].a,this.cells[e][s].tempB+=this.cells[e-1][s].b*this.cells[e-1][s].a,this.cells[e][s].tempA+=this.cells[e-1][s].a),this.cells[e-1][s+1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e-1][s+1].r*this.cells[e-1][s+1].a,this.cells[e][s].tempG+=this.cells[e-1][s+1].g*this.cells[e-1][s+1].a,this.cells[e][s].tempB+=this.cells[e-1][s+1].b*this.cells[e-1][s+1].a,this.cells[e][s].tempA+=this.cells[e-1][s+1].a),this.cells[e][s+1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e][s+1].r*this.cells[e][s+1].a,this.cells[e][s].tempG+=this.cells[e][s+1].g*this.cells[e][s+1].a,this.cells[e][s].tempB+=this.cells[e][s+1].b*this.cells[e][s+1].a,this.cells[e][s].tempA+=this.cells[e][s+1].a),this.cells[e+1][s+1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e+1][s+1].r*this.cells[e+1][s+1].a,this.cells[e][s].tempG+=this.cells[e+1][s+1].g*this.cells[e+1][s+1].a,this.cells[e][s].tempB+=this.cells[e+1][s+1].b*this.cells[e+1][s+1].a,this.cells[e][s].tempA+=this.cells[e+1][s+1].a),this.cells[e+1][s].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e+1][s].r*this.cells[e+1][s].a,this.cells[e][s].tempG+=this.cells[e+1][s].g*this.cells[e+1][s].a,this.cells[e][s].tempB+=this.cells[e+1][s].b*this.cells[e+1][s].a,this.cells[e][s].tempA+=this.cells[e+1][s].a),this.cells[e-1][s].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e-1][s+1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e][s+1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e+1][s+1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e+1][s].energized===!0&&this.cells[e][s].energizedNeighbours++):0===e?(this.cells[e][s+1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e][s+1].r*this.cells[e][s+1].a,this.cells[e][s].tempG+=this.cells[e][s+1].g*this.cells[e][s+1].a,this.cells[e][s].tempB+=this.cells[e][s+1].b*this.cells[e][s+1].a,this.cells[e][s].tempA+=this.cells[e][s+1].a),this.cells[e+1][s+1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e+1][s+1].r*this.cells[e+1][s+1].a,this.cells[e][s].tempG+=this.cells[e+1][s+1].g*this.cells[e+1][s+1].a,this.cells[e][s].tempB+=this.cells[e+1][s+1].b*this.cells[e+1][s+1].a,this.cells[e][s].tempA+=this.cells[e+1][s+1].a),this.cells[e+1][s].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e+1][s].r*this.cells[e+1][s].a,this.cells[e][s].tempG+=this.cells[e+1][s].g*this.cells[e+1][s].a,this.cells[e][s].tempB+=this.cells[e+1][s].b*this.cells[e+1][s].a,this.cells[e][s].tempA+=this.cells[e+1][s].a),this.cells[e+1][s-1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e+1][s-1].r*this.cells[e+1][s-1].a,this.cells[e][s].tempG+=this.cells[e+1][s-1].g*this.cells[e+1][s-1].a,this.cells[e][s].tempB+=this.cells[e+1][s-1].b*this.cells[e+1][s-1].a,this.cells[e][s].tempA+=this.cells[e+1][s-1].a),this.cells[e][s-1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e][s-1].r*this.cells[e][s-1].a,this.cells[e][s].tempG+=this.cells[e][s-1].g*this.cells[e][s-1].a,this.cells[e][s].tempB+=this.cells[e][s-1].b*this.cells[e][s-1].a,this.cells[e][s].tempA+=this.cells[e][s-1].a),this.cells[e][s+1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e+1][s+1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e+1][s].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e+1][s-1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e][s-1].energized===!0&&this.cells[e][s].energizedNeighbours++):e==this.size-1?(this.cells[e][s+1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e][s+1].r*this.cells[e][s+1].a,this.cells[e][s].tempG+=this.cells[e][s+1].g*this.cells[e][s+1].a,this.cells[e][s].tempB+=this.cells[e][s+1].b*this.cells[e][s+1].a,this.cells[e][s].tempA+=this.cells[e][s+1].a),this.cells[e-1][s+1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e-1][s+1].r*this.cells[e-1][s+1].a,this.cells[e][s].tempG+=this.cells[e-1][s+1].g*this.cells[e-1][s+1].a,this.cells[e][s].tempB+=this.cells[e-1][s+1].b*this.cells[e-1][s+1].a,this.cells[e][s].tempA+=this.cells[e-1][s+1].a),this.cells[e-1][s].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e-1][s].r*this.cells[e-1][s].a,this.cells[e][s].tempG+=this.cells[e-1][s].g*this.cells[e-1][s].a,this.cells[e][s].tempB+=this.cells[e-1][s].b*this.cells[e-1][s].a,this.cells[e][s].tempA+=this.cells[e-1][s].a),this.cells[e-1][s-1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e-1][s-1].r*this.cells[e-1][s-1].a,this.cells[e][s].tempG+=this.cells[e-1][s-1].g*this.cells[e-1][s-1].a,this.cells[e][s].tempB+=this.cells[e-1][s-1].b*this.cells[e-1][s-1].a,this.cells[e][s].tempA+=this.cells[e-1][s-1].a),this.cells[e][s-1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e][s-1].r*this.cells[e][s-1].a,this.cells[e][s].tempG+=this.cells[e][s-1].g*this.cells[e][s-1].a,this.cells[e][s].tempB+=this.cells[e][s-1].b*this.cells[e][s-1].a,this.cells[e][s].tempA+=this.cells[e][s-1].a),this.cells[e][s+1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e-1][s+1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e-1][s].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e-1][s-1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e][s-1].energized===!0&&this.cells[e][s].energizedNeighbours++):s==this.size-1?(this.cells[e-1][s].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e-1][s].r*this.cells[e-1][s].a,this.cells[e][s].tempG+=this.cells[e-1][s].g*this.cells[e-1][s].a,this.cells[e][s].tempB+=this.cells[e-1][s].b*this.cells[e-1][s].a,this.cells[e][s].tempA+=this.cells[e-1][s].a),this.cells[e-1][s-1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e-1][s-1].r*this.cells[e-1][s-1].a,this.cells[e][s].tempG+=this.cells[e-1][s-1].g*this.cells[e-1][s-1].a,this.cells[e][s].tempB+=this.cells[e-1][s-1].b*this.cells[e-1][s-1].a,this.cells[e][s].tempA+=this.cells[e-1][s-1].a),this.cells[e][s-1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e][s-1].r*this.cells[e][s-1].a,this.cells[e][s].tempG+=this.cells[e][s-1].g*this.cells[e][s-1].a,this.cells[e][s].tempB+=this.cells[e][s-1].b*this.cells[e][s-1].a,this.cells[e][s].tempA+=this.cells[e][s-1].a),this.cells[e+1][s-1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e+1][s-1].r*this.cells[e+1][s-1].a,this.cells[e][s].tempG+=this.cells[e+1][s-1].g*this.cells[e+1][s-1].a,this.cells[e][s].tempB+=this.cells[e+1][s-1].b*this.cells[e+1][s-1].a,this.cells[e][s].tempA+=this.cells[e+1][s-1].a),this.cells[e+1][s].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e+1][s].r*this.cells[e+1][s].a,this.cells[e][s].tempG+=this.cells[e+1][s].g*this.cells[e+1][s].a,this.cells[e][s].tempB+=this.cells[e+1][s].b*this.cells[e+1][s].a,this.cells[e][s].tempA+=this.cells[e+1][s].a),this.cells[e-1][s].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e-1][s-1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e][s-1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e+1][s-1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e+1][s].energized===!0&&this.cells[e][s].energizedNeighbours++):(this.cells[e-1][s-1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e-1][s-1].r*this.cells[e-1][s-1].a,this.cells[e][s].tempG+=this.cells[e-1][s-1].g*this.cells[e-1][s-1].a,this.cells[e][s].tempB+=this.cells[e-1][s-1].b*this.cells[e-1][s-1].a,this.cells[e][s].tempA+=this.cells[e-1][s-1].a),this.cells[e][s-1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e][s-1].r*this.cells[e][s-1].a,this.cells[e][s].tempG+=this.cells[e][s-1].g*this.cells[e][s-1].a,this.cells[e][s].tempB+=this.cells[e][s-1].b*this.cells[e][s-1].a,this.cells[e][s].tempA+=this.cells[e][s-1].a),this.cells[e+1][s-1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e+1][s-1].r*this.cells[e+1][s-1].a,this.cells[e][s].tempG+=this.cells[e+1][s-1].g*this.cells[e+1][s-1].a,this.cells[e][s].tempB+=this.cells[e+1][s-1].b*this.cells[e+1][s-1].a,this.cells[e][s].tempA+=this.cells[e+1][s-1].a),this.cells[e+1][s].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e+1][s].r*this.cells[e+1][s].a,this.cells[e][s].tempG+=this.cells[e+1][s].g*this.cells[e+1][s].a,this.cells[e][s].tempB+=this.cells[e+1][s].b*this.cells[e+1][s].a,this.cells[e][s].tempA+=this.cells[e+1][s].a),this.cells[e+1][s+1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e+1][s+1].r*this.cells[e+1][s+1].a,this.cells[e][s].tempG+=this.cells[e+1][s+1].g*this.cells[e+1][s+1].a,this.cells[e][s].tempB+=this.cells[e+1][s+1].b*this.cells[e+1][s+1].a,this.cells[e][s].tempA+=this.cells[e+1][s+1].a),this.cells[e][s+1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e][s+1].r*this.cells[e][s+1].a,this.cells[e][s].tempG+=this.cells[e][s+1].g*this.cells[e][s+1].a,this.cells[e][s].tempB+=this.cells[e][s+1].b*this.cells[e][s+1].a,this.cells[e][s].tempA+=this.cells[e][s+1].a),this.cells[e-1][s+1].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e-1][s+1].r*this.cells[e-1][s+1].a,this.cells[e][s].tempG+=this.cells[e-1][s+1].g*this.cells[e-1][s+1].a,this.cells[e][s].tempB+=this.cells[e-1][s+1].b*this.cells[e-1][s+1].a,this.cells[e][s].tempA+=this.cells[e-1][s+1].a),this.cells[e-1][s].isAlive===!0&&(this.cells[e][s].neighbours++,this.cells[e][s].tempR+=this.cells[e-1][s].r*this.cells[e-1][s].a,this.cells[e][s].tempG+=this.cells[e-1][s].g*this.cells[e-1][s].a,this.cells[e][s].tempB+=this.cells[e-1][s].b*this.cells[e-1][s].a,this.cells[e][s].tempA+=this.cells[e-1][s].a),this.cells[e-1][s-1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e][s-1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e+1][s-1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e+1][s].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e+1][s+1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e][s+1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e-1][s+1].energized===!0&&this.cells[e][s].energizedNeighbours++,this.cells[e-1][s].energized===!0&&this.cells[e][s].energizedNeighbours++))},updateCells:function(){for(var e=0;e<this.size;e++)for(var s=0;s<this.size;s++)this.cells[e][s].isSpawner===!1&&(this.cells[e][s].neighbours>0&&(this.cells[e][s].isAlive=!0),this.cells[e][s].isAlive===!0&&0!=this.cells[e][s].neighbours&&(this.cells[e][s].tempR/=this.cells[e][s].neighbours,this.cells[e][s].tempG/=this.cells[e][s].neighbours,this.cells[e][s].tempB/=this.cells[e][s].neighbours,this.cells[e][s].tempA/=2*this.cells[e][s].neighbours,this.cells[e][s].r=Math.round(this.cells[e][s].tempR),this.cells[e][s].g=Math.round(this.cells[e][s].tempG),this.cells[e][s].b=Math.round(this.cells[e][s].tempB),this.cells[e][s].a+=this.cells[e][s].tempA,this.cells[e][s].a>1&&(this.cells[e][s].a=1),this.cells[e][s].tempR=0,this.cells[e][s].tempG=0,this.cells[e][s].tempB=0,this.cells[e][s].tempA=0),0!=this.updateRate&&5!=this.updateRate||this.cells[e][s].isAlive===!0&&(this.cells[e][s].r-=1,this.cells[e][s].g-=1,this.cells[e][s].b-=1,this.cells[e][s].r<0&&(this.cells[e][s].r=0),this.cells[e][s].g<0&&(this.cells[e][s].g=0),this.cells[e][s].b<0&&(this.cells[e][s].b=0)),(this.cells[e][s].r+this.cells[e][s].g+this.cells[e][s].b<=10&&this.cells[e][s].isAlive===!0||0==this.cells[e][s].neighbours&&this.cells[e][s].isAlive===!0)&&(this.cells[e][s].r=0,this.cells[e][s].g=0,this.cells[e][s].b=0,this.cells[e][s].a=0,this.cells[e][s].isAlive=!1,this.cells[e][s].energized=!1),0==this.updateRate&&this.cells[e][s].isAlive===!0&&(0==this.cells[e][s].energizedNeighbours&&this.cells[e][s].energized===!0?this.cells[e][s].energized=!1:2==this.cells[e][s].energizedNeighbours&&this.cells[e][s].energized===!0?this.cells[e][s].energized=!1:this.cells[e][s].energizedNeighbours>=4&&this.cells[e][s].energizedNeighbours<=8&&this.cells[e][s].energized===!0&&(this.cells[e][s].energized=!1),1==this.cells[e][s].energizedNeighbours&&this.cells[e][s].energized===!1&&(this.cells[e][s].energized=!0)),this.cells[e][s].neighbours=0,this.cells[e][s].energizedNeighbours=0)},updateGeometries:function(){for(var e=0,s=0;s<this.size;s++)for(var l=0;l<this.size;l++){if(this.cells[s][l].energized===!0){var i=this.cells[s][l].r+Math.round(f.value*q.value),t=this.cells[s][l].g+Math.round(R.value*q.value),h=this.cells[s][l].b+Math.round(B.value*q.value);a.geometries[e].material.color=new THREE.Color("rgb("+i+","+t+","+h+")")}else a.geometries[e].material.color=new THREE.Color("rgb("+this.cells[s][l].r+","+this.cells[s][l].g+","+this.cells[s][l].b+")");a.geometries[e].material.opacity=this.cells[s][l].a,e++}this.composer.render()},updateAll:function(e,s,l,i){a.updateSpawners(e),a.checkNeighbours(),a.updateCells(),a.view3D===!1?a.draw(s,l,i):a.updateGeometries(),a.updateRate++,a.updateRate>10&&(a.updateRate=0)},getCellData:function(e){return this.cells[e.x][e.y]}},u=256,z="media/Koharu Biyori.mp3",g=!1,d=void 0,m=void 0,p=void 0,b=void 0,v=!0,A=void 0,y=void 0,S=void 0,f=void 0,R=void 0,B=void 0,q=void 0,C=void 0,N=!1,G=!1,w=!1,T={x:0,y:0},E=!1,k=void 0,x=!1,H={};H.x=0,H.y=0;var M={x:-1,y:-1};window.addEventListener("load",e)}();